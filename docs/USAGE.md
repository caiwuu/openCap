# 截图工具使用说明

## 功能特点

✅ **QQ风格截图**: 100%复刻QQ截图功能  
✅ **系统托盘**: 启动后在状态栏显示图标，无主窗口  
✅ **瞬间截图**: 使用原生API瞬间冻结当前帧  
✅ **持久运行**: 完成截图后继续在后台运行  
✅ **Retina支持**: 完美支持高分辨率屏幕  
✅ **状态栏覆盖**: 使用原生Cocoa API覆盖状态栏区域（最新版本）  

## 编译运行

```bash
# 编译项目
cd build
cmake ..
make -j4

# 运行应用
./test_jietu.sh
```

## 使用方法

1. **启动应用**: 运行后会在状态栏显示图标
2. **开始截图**: 
   - 双击状态栏图标
   - 或右键选择"截图"
3. **选择区域**: 拖拽鼠标选择截图区域
4. **完成截图**: 释放鼠标自动保存到桌面
5. **取消截图**: 按 ESC 键取消
6. **退出应用**: 右键状态栏图标选择"退出"

## 截图功能

- **区域选择**: 实时显示选择框坐标和尺寸
- **视觉反馈**: 半透明遮罩突出选择区域
- **自动保存**: 截图自动保存到桌面，文件名包含时间戳
- **状态栏覆盖**: 使用原生macOS Cocoa API覆盖状态栏，实现真正的全屏截图

## 快捷键

- `ESC`: 取消截图
- `左键拖拽`: 选择截图区域

## 技术特性

- **Qt6**: 使用现代Qt框架开发
- **原生API**: macOS上使用Cocoa API设置窗口层级
- **跨平台**: 支持macOS，可扩展到其他平台
- **内存安全**: 使用智能指针管理资源
- **高性能**: 原生屏幕捕获API，响应迅速

## 状态栏覆盖技术细节

在macOS上，应用使用原生Cocoa API来解决状态栏覆盖问题：

```cpp
// 设置窗口层级高于状态栏（NSStatusWindowLevel = 25）
[window setLevel:NSStatusWindowLevel + 1];
```

- **窗口层级**: 设置为26，高于状态栏的25
- **不创建新桌面**: 使用`show()`而不是`showFullScreen()`
- **原生集成**: 通过Objective-C++调用Cocoa框架

## 调试信息

运行时会输出详细的调试信息，包括：
- 屏幕捕获状态和尺寸信息
- 窗口创建和显示过程
- 原生API窗口层级设置过程
- 选择区域坐标和文件保存路径

## 注意事项

⚠️ **屏幕录制权限**: macOS首次运行时需要在"系统偏好设置 > 安全性与隐私 > 隐私 > 屏幕录制"中添加应用权限

## 版本历史

- **v1.0**: 基础截图功能，使用Qt窗口标志
- **v1.1**: 添加原生Cocoa API，解决状态栏覆盖问题 